(function(t){function e(e){for(var s,i,o=e[0],c=e[1],u=e[2],d=0,f=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},a={app:0},r=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"025a":function(t,e,n){},"0adb":function(t,e,n){"use strict";var s=n("e63c"),a=n.n(s);a.a},"22b8":function(t,e,n){"use strict";var s=n("9246"),a=n.n(s);a.a},"34a1":function(t,e,n){},"39c4":function(t,e,n){"use strict";var s=n("709a"),a=n.n(s);a.a},"4aba":function(t,e,n){},"4f59":function(t,e,n){"use strict";var s=n("34a1"),a=n.n(s);a.a},"56d7":function(t,e,n){"use strict";n.r(e);var s={};n.r(s),n.d(s,"setChats",(function(){return Pt})),n.d(s,"setLoading",(function(){return Mt})),n.d(s,"setMessages",(function(){return Lt})),n.d(s,"addMessage",(function(){return $t}));var a={};n.r(a),n.d(a,"fetchChats",(function(){return Bt})),n.d(a,"fetchMessages",(function(){return Wt})),n.d(a,"addMessage",(function(){return At}));n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],c=(n("7faf"),n("2877")),u={},l=Object(c["a"])(u,i,o,!1,null,null,null),d=l.exports,f=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"messages"},[n("ChatsList",{attrs:{chats:t.chats,selected:t.selectedChat}}),n("div",{staticClass:"messages__conversation"},[n("router-view")],1)],1)},m=[],h=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),v=n("2f62"),b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-list"},[n("div",{staticClass:"chat-list__header"},[t._v("\n    Сообщения\n    "),n("span",{staticClass:"chat-list__counter"},[t._v(t._s(t.chatsCount))])]),n("div",{staticClass:"chat-list__items"},t._l(t.chats,(function(e){return n("ChatListItem",{key:e.id,attrs:{selected:e.id===t.selected,chat:e}})})),1)])},g=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{class:{"chat-list-item":!0,"chat-list-item--selected":t.selected},attrs:{to:"/"+t.chat.id}},[n("div",{staticClass:"chat-list-item__header"},[n("div",{staticClass:"chat-list-item__title"},[t._v("\n      "+t._s(t.chat.subject)+"\n    ")]),n("div",{staticClass:"chat-list-item__date"},[t._v("\n      "+t._s(t._f("date")(t.chat.created))+"\n    ")])]),n("div",{staticClass:"chat-list-item__message"},[t._v("\n    "+t._s(t.chat.message)+"\n  ")])])},O=[],y={props:{selected:Boolean,chat:Object},filters:{date:function(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},j=y,C=(n("39c4"),Object(c["a"])(j,_,O,!1,null,null,null)),w=C.exports,x={components:{ChatListItem:w},props:["chats","selected"],computed:{chatsCount:function(){return this.chats?this.chats.length:0}}},P=x,M=(n("22b8"),Object(c["a"])(P,b,g,!1,null,null,null)),L=M.exports;function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(n,!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={components:{ChatsList:L},created:function(){this.fetchChats()},methods:E({},Object(v["b"])(["fetchChats"])),computed:E({},Object(v["c"])(["chats"]),{selectedChat:function(){return+this.$route.params.id}})},S=D,k=(n("b3ef"),Object(c["a"])(S,p,m,!1,null,null,null)),T=k.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("LoadableContent",{attrs:{loading:t.isLoading}},[n("Conversation",{attrs:{messages:t.messages,disabled:t.isLoading},on:{message:t.onAddMessage}})],1)},q=[],B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"conversation"},[n("div",{staticClass:"conversation__messages"},[n("ConversationMessages",{attrs:{messages:t.messages}})],1),n("div",{staticClass:"conversation__input-box"},[n("InputBox",{attrs:{disabled:t.disabled},on:{submit:function(e){return t.$emit("message",e)}}})],1)])},W=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"conversation-messages"},[n("div",{ref:"container",staticClass:"conversation-messages__items"},t._l(t.messages,(function(t){return n("ConversationMessageItem",{key:t.id,attrs:{message:t,self:"vasiliy"===t.author}})})),1)])},J=[],z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"conversation-message-item":!0,"conversation-message-item--self":t.self}},[n("div",{staticClass:"conversation-message-item__message"},[t._v("\n    "+t._s(t.message.text)+"\n  ")]),n("div",{staticClass:"conversation-message-item__footer"},[n("div",{staticClass:"conversation-message-item__title"},[t._v("\n      "+t._s(t.message.author)+"\n    ")]),n("div",{staticClass:"conversation-message-item__date"},[t._v("\n      "+t._s(t._f("datetime")(t.message.created))+"\n    ")])])])},H=[],N={props:{self:Boolean,message:Object},filters:{datetime:function(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}}},F=N,G=(n("abd5"),Object(c["a"])(F,z,H,!1,null,null,null)),K=G.exports,Q={components:{ConversationMessageItem:K},props:["messages"],watch:{messages:function(){var t=this;this.$nextTick((function(){var e=t.$refs.container;e.scrollTop=e.scrollHeight}))}}},R=Q,U=(n("4f59"),Object(c["a"])(R,A,J,!1,null,null,null)),V=U.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"input-box",on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],ref:"input",staticClass:"input-box__input",attrs:{type:"text",placeholder:"Введите текст..."},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),n("button",{staticClass:"input-box__send",attrs:{disabled:t.disabled}},[n("svg",{attrs:{width:"22",height:"18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 17.26c.01.35.37.6.7.46l20.17-8.26a.5.5 0 000-.92L.7.28a.5.5 0 00-.7.46v5.82c0\n       .25.19.46.44.5L11.82 8.5c.58.08.58.92 0 1L.44 10.94a.5.5 0 00-.44.5v5.82z",fill:"#fff"}})])])])},Y=[],Z={props:{disabled:Boolean},data:function(){return{message:""}},methods:{onSubmit:function(){this.message&&!this.disabled&&(this.$emit("submit",this.message),this.message="",this.$refs.input.focus())}}},tt=Z,et=(n("8065"),Object(c["a"])(tt,X,Y,!1,null,null,null)),nt=et.exports,st={components:{ConversationMessages:V,InputBox:nt},props:["messages","disabled"]},at=st,rt=(n("0adb"),Object(c["a"])(at,B,W,!1,null,null,null)),it=rt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"loadable-content"},[t.loading?n("div",{staticClass:"loadable-content__spinner"},[n("div"),n("div"),n("div"),n("div")]):t._e(),t._t("default")],2)},ct=[],ut={props:{loading:Boolean}},lt=ut,dt=(n("ac48"),Object(c["a"])(lt,ot,ct,!1,null,null,null)),ft=dt.exports;function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(n,!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht={components:{Conversation:it,LoadableContent:ft},methods:mt({},Object(v["b"])(["fetchMessages","addMessage"]),{onAddMessage:function(t){this.addMessage({message:t,chatId:+this.$route.params.id})}}),computed:mt({},Object(v["c"])(["messages","isLoading"])),watch:{"$route.params.id":{immediate:!0,handler:function(t){this.fetchMessages(+t)}}}},vt=ht,bt=Object(c["a"])(vt,I,q,!1,null,null,null),gt=bt.exports,_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-not-selected"},[t._v("\n  Чат не выбран\n")])},Ot=[],yt=(n("6df6"),{}),jt=Object(c["a"])(yt,_t,Ot,!1,null,null,null),Ct=jt.exports;r["a"].use(f["a"]);var wt=new f["a"]({mode:"history",base:"/",routes:[{path:"/",component:T,children:[{path:"",component:Ct},{path:":id",component:gt}]}]}),xt={chats:[],messages:[],isLoading:!1},Pt=function(t,e){t.chats=e},Mt=function(t,e){t.isLoading=e},Lt=function(t,e){t.messages=e},$t=function(t,e){t.messages.push(e)},Et=n("75fc"),Dt=(n("7514"),n("d225")),St=n("b0b4");function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function Tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(n,!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var It=function(){function t(){Object(Dt["a"])(this,t)}return Object(St["a"])(t,null,[{key:"promiseWithTimeout",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(s){setTimeout((function(){s(t)}),Math.random()*(e-n)+n)}))}},{key:"getMessages",value:function(e){var n=t.data.find((function(t){return t.id===e}));return t.promiseWithTimeout(n?Object(Et["a"])(n.parts):[],1500,500)}},{key:"getChats",value:function(){var e=t.data.map((function(t){return{id:t.id,subject:t.subject,created:t.created,message:t.parts[0]&&t.parts[0].text}}));return t.promiseWithTimeout(Object(Et["a"])(e),0,0)}},{key:"addMessage",value:function(e,n){var s=t.data.find((function(t){return t.id===e})),a={id:s.parts.length+1,author:"vasiliy",text:n,created:(new Date).toISOString()};return s.parts.push(a),t.promiseWithTimeout(Tt({},a),100,50)}}]),t}();Object(h["a"])(It,"data",[{id:1,subject:"Простой запрос",created:"2019-08-01 23:59",parts:[{id:1,author:"vasya",text:"Привет, как дела?",created:"2019-08-01 23:59"},{id:2,author:"petya",created:"2019-08-02 01:20",text:"Привет, все хорошо, спасибо!"},{id:3,author:"petya",created:"2019-08-02 05:20",text:"А у тебя?"}]},{id:2,subject:"Вопрос по домену",created:"2016-03-02 14:19",parts:[{id:1,author:"petr",created:"2019-08-06 12:20",text:"Здравствуйте, тут есть кто-нибудь?"},{id:2,author:"vasiliy",created:"2019-08-06 12:34",text:"Да, я вас слушаю!"},{id:3,author:"petr",created:"2019-08-06 12:38",text:"Помогите мне настроить домен!"}]},{id:3,subject:"Привет",created:"2016-03-02 14:19",parts:[{id:1,author:"vasiliy",created:"2019-08-06 12:20",text:"Morbi hac eligendi totam? Elementum mi facilis aliquet id turpis ultrices mollitia porttitor praesentium animi ullamco eleifend scelerisque, sapien quam explicabo conubia egestas vehicula!"},{id:2,author:"Василий",created:"2019-08-06 12:34",text:"Morbi hac eligendi totam? Elementum mi facilis aliquet id turpis ultrices mollitia porttitor praesentium animi ullamco eleifend scelerisque, sapien quam explicabo conubia egestas vehicula!"}]}]);var qt=It,Bt=function(t){var e=t.commit;qt.getChats().then((function(t){e("setChats",t)}))},Wt=function(t,e){var n=t.commit;n("setLoading",!0),n("setMessages",[]),qt.getMessages(e).then((function(t){n("setMessages",t),n("setLoading",!1)}))},At=function(t,e){var n=t.commit,s=e.chatId,a=e.message;n("setLoading",!0),qt.addMessage(s,a).then((function(t){n("addMessage",t),n("setLoading",!1)}))};r["a"].use(v["a"]);var Jt=new v["a"].Store({state:xt,mutations:s,actions:a});r["a"].config.productionTip=!1,new r["a"]({router:wt,store:Jt,render:function(t){return t(d)}}).$mount("#app")},"6df6":function(t,e,n){"use strict";var s=n("7a7b"),a=n.n(s);a.a},"709a":function(t,e,n){},"7a7b":function(t,e,n){},"7b59":function(t,e,n){},"7faf":function(t,e,n){"use strict";var s=n("8fba"),a=n.n(s);a.a},8065:function(t,e,n){"use strict";var s=n("025a"),a=n.n(s);a.a},"8fba":function(t,e,n){},9246:function(t,e,n){},a22c:function(t,e,n){},abd5:function(t,e,n){"use strict";var s=n("4aba"),a=n.n(s);a.a},ac48:function(t,e,n){"use strict";var s=n("7b59"),a=n.n(s);a.a},b3ef:function(t,e,n){"use strict";var s=n("a22c"),a=n.n(s);a.a},e63c:function(t,e,n){}});
//# sourceMappingURL=app.4ae5b33f.js.map