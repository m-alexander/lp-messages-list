(function(t){function e(e){for(var n,i,o=e[0],c=e[1],u=e[2],d=0,f=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],n=!0,o=1;o<s.length;o++){var c=s[o];0!==a[c]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var n={},a={app:0},r=[];function i(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=n,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/lp-messages-list/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"025a":function(t,e,s){},"0adb":function(t,e,s){"use strict";var n=s("e63c"),a=s.n(n);a.a},"22b8":function(t,e,s){"use strict";var n=s("9246"),a=s.n(n);a.a},"34a1":function(t,e,s){},"39c4":function(t,e,s){"use strict";var n=s("709a"),a=s.n(n);a.a},"4aba":function(t,e,s){},"4f59":function(t,e,s){"use strict";var n=s("34a1"),a=s.n(n);a.a},"56d7":function(t,e,s){"use strict";s.r(e);var n={};s.r(n),s.d(n,"setChats",(function(){return Pt})),s.d(n,"setLoading",(function(){return Mt})),s.d(n,"setMessages",(function(){return Lt})),s.d(n,"addMessage",(function(){return $t}));var a={};s.r(a),s.d(a,"fetchChats",(function(){return Bt})),s.d(a,"fetchMessages",(function(){return Wt})),s.d(a,"addMessage",(function(){return At}));s("cadf"),s("551c"),s("f751"),s("097d");var r=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},o=[],c=(s("7faf"),s("2877")),u={},l=Object(c["a"])(u,i,o,!1,null,null,null),d=l.exports,f=s("8c4f"),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"messages"},[s("ChatsList",{attrs:{chats:t.chats,selected:t.selectedChat}}),s("div",{staticClass:"messages__conversation"},[s("router-view")],1)],1)},m=[],h=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),v=s("2f62"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-list"},[s("div",{staticClass:"chat-list__header"},[t._v("\n    Сообщения\n    "),s("span",{staticClass:"chat-list__counter"},[t._v(t._s(t.chatsCount))])]),s("div",{staticClass:"chat-list__items"},t._l(t.chats,(function(e){return s("ChatListItem",{key:e.id,attrs:{selected:e.id===t.selected,chat:e}})})),1)])},b=[],_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-link",{class:{"chat-list-item":!0,"chat-list-item--selected":t.selected},attrs:{to:"/"+t.chat.id}},[s("div",{staticClass:"chat-list-item__header"},[s("div",{staticClass:"chat-list-item__title"},[t._v("\n      "+t._s(t.chat.subject)+"\n    ")]),s("div",{staticClass:"chat-list-item__date"},[t._v("\n      "+t._s(t._f("date")(t.chat.created))+"\n    ")])]),s("div",{staticClass:"chat-list-item__message"},[t._v("\n    "+t._s(t.chat.message)+"\n  ")])])},O=[],y={props:{selected:Boolean,chat:Object},filters:{date:function(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},j=y,C=(s("39c4"),Object(c["a"])(j,_,O,!1,null,null,null)),w=C.exports,x={components:{ChatListItem:w},props:["chats","selected"],computed:{chatsCount:function(){return this.chats?this.chats.length:0}}},P=x,M=(s("22b8"),Object(c["a"])(P,g,b,!1,null,null,null)),L=M.exports;function $(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function E(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$(s,!0).forEach((function(e){Object(h["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var D={components:{ChatsList:L},created:function(){this.fetchChats()},methods:E({},Object(v["b"])(["fetchChats"])),computed:E({},Object(v["c"])(["chats"]),{selectedChat:function(){return+this.$route.params.id}})},S=D,k=(s("b3ef"),Object(c["a"])(S,p,m,!1,null,null,null)),T=k.exports,I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("LoadableContent",{attrs:{loading:t.isLoading}},[s("Conversation",{attrs:{messages:t.messages,disabled:t.isLoading},on:{message:t.onAddMessage}})],1)},q=[],B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"conversation"},[s("div",{staticClass:"conversation__messages"},[s("ConversationMessages",{attrs:{messages:t.messages}})],1),s("div",{staticClass:"conversation__input-box"},[s("InputBox",{attrs:{disabled:t.disabled},on:{submit:function(e){return t.$emit("message",e)}}})],1)])},W=[],A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"conversation-messages"},[s("div",{ref:"container",staticClass:"conversation-messages__items"},t._l(t.messages,(function(t){return s("ConversationMessageItem",{key:t.id,attrs:{message:t,self:"vasiliy"===t.author}})})),1)])},J=[],z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"conversation-message-item":!0,"conversation-message-item--self":t.self}},[s("div",{staticClass:"conversation-message-item__message"},[t._v("\n    "+t._s(t.message.text)+"\n  ")]),s("div",{staticClass:"conversation-message-item__footer"},[s("div",{staticClass:"conversation-message-item__title"},[t._v("\n      "+t._s(t.message.author)+"\n    ")]),s("div",{staticClass:"conversation-message-item__date"},[t._v("\n      "+t._s(t._f("datetime")(t.message.created))+"\n    ")])])])},H=[],N={props:{self:Boolean,message:Object},filters:{datetime:function(t){return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}}},F=N,G=(s("abd5"),Object(c["a"])(F,z,H,!1,null,null,null)),K=G.exports,Q={components:{ConversationMessageItem:K},props:["messages"],watch:{messages:function(){var t=this;this.$nextTick((function(){var e=t.$refs.container;e.scrollTop=e.scrollHeight}))}}},R=Q,U=(s("4f59"),Object(c["a"])(R,A,J,!1,null,null,null)),V=U.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"input-box",on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],ref:"input",staticClass:"input-box__input",attrs:{type:"text",placeholder:"Введите текст..."},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),s("button",{staticClass:"input-box__send",attrs:{disabled:t.disabled}},[s("svg",{attrs:{width:"22",height:"18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M0 17.26c.01.35.37.6.7.46l20.17-8.26a.5.5 0 000-.92L.7.28a.5.5 0 00-.7.46v5.82c0\n       .25.19.46.44.5L11.82 8.5c.58.08.58.92 0 1L.44 10.94a.5.5 0 00-.44.5v5.82z",fill:"#fff"}})])])])},Y=[],Z={props:{disabled:Boolean},data:function(){return{message:""}},methods:{onSubmit:function(){this.message&&!this.disabled&&(this.$emit("submit",this.message),this.message="",this.$refs.input.focus())}}},tt=Z,et=(s("8065"),Object(c["a"])(tt,X,Y,!1,null,null,null)),st=et.exports,nt={components:{ConversationMessages:V,InputBox:st},props:["messages","disabled"]},at=nt,rt=(s("0adb"),Object(c["a"])(at,B,W,!1,null,null,null)),it=rt.exports,ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"loadable-content"},[t.loading?s("div",{staticClass:"loadable-content__spinner"},[s("div"),s("div"),s("div"),s("div")]):t._e(),t._t("default")],2)},ct=[],ut={props:{loading:Boolean}},lt=ut,dt=(s("ac48"),Object(c["a"])(lt,ot,ct,!1,null,null,null)),ft=dt.exports;function pt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function mt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?pt(s,!0).forEach((function(e){Object(h["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):pt(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var ht={components:{Conversation:it,LoadableContent:ft},methods:mt({},Object(v["b"])(["fetchMessages","addMessage"]),{onAddMessage:function(t){this.addMessage({message:t,chatId:+this.$route.params.id})}}),computed:mt({},Object(v["c"])(["messages","isLoading"])),watch:{"$route.params.id":{immediate:!0,handler:function(t){this.fetchMessages(+t)}}}},vt=ht,gt=Object(c["a"])(vt,I,q,!1,null,null,null),bt=gt.exports,_t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-not-selected"},[t._v("\n  Чат не выбран\n")])},Ot=[],yt=(s("6df6"),{}),jt=Object(c["a"])(yt,_t,Ot,!1,null,null,null),Ct=jt.exports;r["a"].use(f["a"]);var wt=new f["a"]({mode:"history",base:"/lp-messages-list/",routes:[{path:"/",component:T,children:[{path:"",component:Ct},{path:":id",component:bt}]}]}),xt={chats:[],messages:[],isLoading:!1},Pt=function(t,e){t.chats=e},Mt=function(t,e){t.isLoading=e},Lt=function(t,e){t.messages=e},$t=function(t,e){t.messages.push(e)},Et=s("75fc"),Dt=(s("7514"),s("d225")),St=s("b0b4");function kt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function Tt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?kt(s,!0).forEach((function(e){Object(h["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):kt(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var It=function(){function t(){Object(Dt["a"])(this,t)}return Object(St["a"])(t,null,[{key:"promiseWithTimeout",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(n){setTimeout((function(){n(t)}),Math.random()*(e-s)+s)}))}},{key:"getMessages",value:function(e){var s=t.data.find((function(t){return t.id===e}));return t.promiseWithTimeout(s?Object(Et["a"])(s.parts):[],1500,500)}},{key:"getChats",value:function(){var e=t.data.map((function(t){return{id:t.id,subject:t.subject,created:t.created,message:t.parts[0]&&t.parts[0].text}}));return t.promiseWithTimeout(Object(Et["a"])(e),0,0)}},{key:"addMessage",value:function(e,s){var n=t.data.find((function(t){return t.id===e})),a={id:n.parts.length+1,author:"vasiliy",text:s,created:(new Date).toISOString()};return n.parts.push(a),t.promiseWithTimeout(Tt({},a),100,50)}}]),t}();Object(h["a"])(It,"data",[{id:1,subject:"Простой запрос",created:"2019-08-01 23:59",parts:[{id:1,author:"vasiliy",text:"Привет, как дела?",created:"2019-08-01 23:59"},{id:2,author:"petya",created:"2019-08-02 01:20",text:"Привет, все хорошо, спасибо!"},{id:3,author:"petya",created:"2019-08-02 05:20",text:"А у тебя?"}]},{id:2,subject:"Вопрос по домену",created:"2016-03-02 14:19",parts:[{id:1,author:"petr",created:"2019-08-06 12:20",text:"Здравствуйте, тут есть кто-нибудь?"},{id:2,author:"vasiliy",created:"2019-08-06 12:34",text:"Да, я вас слушаю!"},{id:3,author:"petr",created:"2019-08-06 12:38",text:"Помогите мне настроить домен!"}]},{id:3,subject:"Привет",created:"2016-03-02 14:19",parts:[{id:1,author:"vasiliy",created:"2019-08-06 12:20",text:"Morbi hac eligendi totam? Elementum mi facilis aliquet id turpis ultrices mollitia porttitor praesentium animi ullamco eleifend scelerisque, sapien quam explicabo conubia egestas vehicula!"},{id:2,author:"Василий",created:"2019-08-06 12:34",text:"Morbi hac eligendi totam? Elementum mi facilis aliquet id turpis ultrices mollitia porttitor praesentium animi ullamco eleifend scelerisque, sapien quam explicabo conubia egestas vehicula!"}]}]);var qt=It,Bt=function(t){var e=t.commit;qt.getChats().then((function(t){e("setChats",t)}))},Wt=function(t,e){var s=t.commit;s("setLoading",!0),s("setMessages",[]),qt.getMessages(e).then((function(t){s("setMessages",t),s("setLoading",!1)}))},At=function(t,e){var s=t.commit,n=e.chatId,a=e.message;s("setLoading",!0),qt.addMessage(n,a).then((function(t){s("addMessage",t),s("setLoading",!1)}))};r["a"].use(v["a"]);var Jt=new v["a"].Store({state:xt,mutations:n,actions:a});r["a"].config.productionTip=!1,new r["a"]({router:wt,store:Jt,render:function(t){return t(d)}}).$mount("#app")},"6df6":function(t,e,s){"use strict";var n=s("7a7b"),a=s.n(n);a.a},"709a":function(t,e,s){},"7a7b":function(t,e,s){},"7b59":function(t,e,s){},"7faf":function(t,e,s){"use strict";var n=s("8fba"),a=s.n(n);a.a},8065:function(t,e,s){"use strict";var n=s("025a"),a=s.n(n);a.a},"8fba":function(t,e,s){},9246:function(t,e,s){},a22c:function(t,e,s){},abd5:function(t,e,s){"use strict";var n=s("4aba"),a=s.n(n);a.a},ac48:function(t,e,s){"use strict";var n=s("7b59"),a=s.n(n);a.a},b3ef:function(t,e,s){"use strict";var n=s("a22c"),a=s.n(n);a.a},e63c:function(t,e,s){}});
//# sourceMappingURL=app.c8e4fb16.js.map